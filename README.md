# Web Pentesting Checklist OWASP 

## Authentication flaw
Authentication adalah proses memverifikasi siapa kita. Authentication flaw seringkali terjadi karena logic flaw.
### Register
#### Bad password policy
- Register dengan password pendek/blank
- Register dengan dictionary password seperti 12345678, letmein, password, nama website, qwerty
- Register dengan password yang sama dengan username
#### Account takeover
- Register dengan email/username yang sudah ada
- Register dengan email perusahaan jika tidak ada fitur verifikasi email/bisa dibypass
- Register dengan email uppercase
- Register dengan +1@, contoh victim+1@gmail.com
- Tambah karakter spesial pada email, %20, %00, %09
- Tambah black character setelah email test@test.com a
- Register dengan victim@gmail.com@attacker.com
- Register dengan victim@attacker.com@gmail.com
### Login
#### User enumeration 
- Login menggunakan password yang benar lalu password yang salah. Identifikasi perbedaan response server seperti status code, redirect, hidden page source, dan response time. Gunakan Burp comparer untuk membandingkan
#### Brute force
- Login dengan password salah, jika sudah 10 kali akun tidak terkunci, berarti tidak ada mekanisme account locking
- Cek cookie apakah menyimpan jumlah percobaan login
- Bypass account locking dengan login menggunakan password yang benar sebelum batas login (misalnya 3 kali) sehingga sessionnya ter-refresh
- Bypass IP blocking dengan menambahkan header X-Forwared-Host, X-Originating-IP, X-Forwarded-For, X-Remote-IP, X-Remote-Addr: 127.0.0.1
#### Login bypass
- Perhatikan response server saat login berhasil, misalnya status code menjadi 200 OK {"login":true}, maka manipulasi response saat login gagal dengan response tersebut
- Cek credential pada page source
- Cek endpoint pada file Javascript
- Kunjungi langsung restricted page
- Cek default credential jika menggunakan CMS/framework
- Login dengan {"password": {"password":1}}
- Cek SQL injection bypass login
#### Vulnerable transmition of credential
- Muat halaman login dengan http, jangan https
- Cek apakah credential ditransmisikan lewat query string
- Cek apakah credential ditransmisikan lewat cookie
### Change password & reset password 
#### User enumeration
- Cek pesan error saat username salah, password salah, dan field password tidak sama dengan konfirmasi password
#### Account takeover
- Override username/email menggunakan nama field yang sama seperti saat login
- Override parameter email: email=victim@mail.com&email=attacker@mail.com
- Ovveride parameter email: {"email": {"email": "victim"}}, {"email": ["victim"]} 
#### Reset token leak via referer header
- Kunjungi URL reset password yang dikirim lewat email, klik external link apapun yang ada di halaman tersebut, maka URL reset password akan tampil di referer header
#### Host header injection
- Intercept request saat meminta link reset password, ubah header Host atau X-Forwarded-Host: evil.com, cek link reset password apakah terdapat domain tersebut
#### Email bombing
- Request link reset password yang banyak hingga email menjadi penuh
#### Reset token link
- Hapus token saat submit password baru, bila valid, berarti token tidak dicek
- Cek apakah linknya masih bisa digunakan jika sudah pernah digunakan
- Cek apakah linknya tetap valid setelah beberapa jam
- Cek apakah pola URL bisa ditebak,
#### Challenge
- Cek apakah user bisa memilih sendiri pertanyaan sebelum bisa mereset password. Cek apakah ada yang jawabannya kemungkinan lemah (seperti ya/tidak, nama warna, nama panggilan, dll). Gunakan teknik user enumeration untuk memilih user dengan pertanyaan yang mudah
- Cek apakah jawaban bisa di brute force
- Lakukan hal yang sama jika terdapat fitur password hint
- Cek apakah setelah menjawab challenge sudah terautentikasi
- Apakah kita bisa memilih email untuk pengiriman reset link
### Remember me
#### Cookie
- Cek apakah fitur ini menggunakan cookie yang mudah ditebak seperti rememberUser: victim
- Meskipun cookie-nya di enkripsi, cek apakah kita bisa melakukan reverse engineering dengan mencoba-coba mengenkripsi username dan lihatlah apakah hasilnya sama
- Cek localStorage apakah terdapat credential
### Multi-step login
#### Logic flaw
- Ikuti flow login sampai akhir
- Identifikasi data apa saja yang ada di client, misalnya query string, post body, cookie, localStorage, atau parameter
- Ubah value tersebut untuk menghasilkan account takeover
- Lewati salah satu step dan langsung ke step berikutnya 
### 2FA 
#### Bypass 2FA
- Langsung kunjungi URL setelah memasukkan kode OTP
- Gunakan OTP yang sudah pernah digunakan
- Gunakan OTP 0000
- Gunakan kode OTP untuk akun lain yang belum digunakan
- Cek apakah OTP ada di response
- Akses link verifikasi email saat pembuatan akun dapat membypass OTP
- Cek apakah bisa brute force OTP
- Cek apakah reset password bisa membypass OTP
- Manipulasi response menjadi 200 OK
- Gunakan versi API lebih lama, misalnya v3 menjadi v2
#### Information Disclosure
- Cek information disclosure email/no. hp di halaman 2FA

## Access control
### Vertical privilege escalation
#### Unprotected administrative page
- Temukan path admin panel di robots.txt, Google dorking, file Javascript, atau directory brute forcing
#### Parameter-based access control
- Temukan access control pada query string, hidden field, cookie, response, atau localStorage
#### URL-based access control
- Tambahkan header X-Original-URL dan X-Rewrite-URL: <restricted page> dan merequest kenGET/POST /
#### Method-based access control
- Ubah method dari GET ke POST atau sebaliknya
#### Location-based access control
- Gunakan VPN/web proxy untuk mengubah lokasi
#### Referer-based access control
- Tambahkan referer: <restricted endpoint>
#### URL discrepancies
- Ubah case URL; /ADMIN, /admin/, /admin.<file extension>
### Horizontal privilege escalation
#### IDOR
- Ubah identifier
- Cek apakah hashed identifier bisa ditebak
- Gunakan parameter polution: id=10&id=11
- Tambahkan parameter di akhir endpoint, contoh: /api/getUser menjadi /api/getUser?id=123
- Tambahkan extension di akhir endpoint, contoh: /api/getUser menjadi /api/getUser?id=123.json
- Cek outdated API, contoh: /api/v2/getUser menjadi /api/v1/getUser?id=123
- Tambahkan id sebagai array, contoh: {"user": [123]}
- Tambahkan id sebagai JSON, contoh: {"user": {"user": 123}}
- JSON parameter pollution, contoh: {"user": 123, "user": 124}
- Encode id dengan base64, MD5, dll
- Ubah UUID dengan angka
- Ubah method HTTP
- Path Traversal, contoh: GET /api/v1/users/profile/my_id/../victim_id
- Ubah Content-Type, contoh: application/xml atau application/json
- Kirim wildcard sebagai identifier, contoh: *, %, _, .
- Tambahkan karakter khusus, contoh: user?id=120%00 / %2f / %ff
